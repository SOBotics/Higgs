<ng-container *ngIf="!!postDetails">
  <h3>
    <img *ngIf="postDetails.botLogo" class="botLogo" src="{{postDetails.botLogo}}" title="{{postDetails.botName}}" />
    <a href="{{link}}">{{postDetails.title}}</a>
    <span *ngFor="let feedback of postDetails.feedback" class="feedback" [style.color]="feedback.colour" [title]="feedback.feedbackName + ' - ' + feedback.userName">
      {{feedback.icon}}
    </span>
  </h3>
  <div>{{postDetails.details}}</div>
  <div class="mt-3" *ngIf="postDetails.detectionScore">
    <b>Detection score: </b> {{postDetails.detectionScore}}
  </div>
  <ng-container *ngIf="postDetails.contentFragments && postDetails.contentFragments.length > 1">
    <ul class="nav nav-tabs mt-3" role="tablist">
      <li class="nav-item" *ngFor="let contentFragment of postDetails.contentFragments | orderBy: 'order'; let i = index;">
        <a class="nav-link" [class.active]="i==0" data-toggle="tab" href="#contentFragment{{contentFragment.id}}" [attr.aria-controls]="contentFragment.name"
          [attr.aria-selected]="i==0">{{contentFragment.name}}</a>
      </li>
    </ul>
    <div class="tab-content">
      <div [class.active]="i==0" [class.show]="i==0" id="contentFragment{{contentFragment.id}}" role="tabpanel" [attr.aria-labelledby]="contentFragment.name"
        *ngFor="let contentFragment of postDetails.contentFragments | orderBy: 'order'; let i = index;" class="tab-pane fade">
        <pre class="mt-3 p-2"><code>{{contentFragment.content}}</code></pre>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="postDetails.contentFragments && postDetails.contentFragments.length === 1">
    <pre class="mt-3 p-2"><code>{{postDetails.contentFragments[0].content}}</code></pre>
  </ng-container>
  <div class="row mt-3">
    <div class="col-md-10">
      <span *ngIf="postDetails.contentCreationDate">Posted {{postDetails.contentCreationDate | timeAgo}}</span>
      <span *ngIf="postDetails.contentCreationDate">|</span>
      <span *ngIf="postDetails.detectedDate">Reported {{postDetails.detectedDate | timeAgo}}</span>
    </div>
    <div class="col-md-2 text-sm-right" *ngIf="postDetails.authorName">
      <span *ngIf="postDetails.authorLink">Posted by
        <a href="{{postDetails.authorLink}}">{{postDetails.authorName}}</a>
      </span>
      <span *ngIf="!postDetails.authorLink">Posted by {{postDetails.authorName}}</span>
      <span *ngIf="postDetails.authorPrevious">({{postDetails.authorPrevious}})</span>
    </div>
  </div>
  <hr *ngIf="postDetails.allowedFeedback && postDetails.allowedFeedback.length" />
  <div class="d-flex flex-row">
    <button *ngFor="let feedback of postDetails.allowedFeedback" type="button" class="btn" style="margin-left: 15px; color: #fff" [style.background-color]="feedback.colour" >{{feedback.name}}</button>
  </div>
  <hr/>
  <div class="mt-3" *ngIf="postDetails.reasons && postDetails.reasons.length">
    <b>Caught by {{postDetails.reasons.length}} reasons:</b>
    <table class="table mt-3">
      <thead>
        <tr>
          <th scope="col">
            Reason
          </th>
          <th scope="col">
            Tripped?
          </th>
          <th scope="col">
            Confidence
          </th>
          <th scope="col">
            Previously seen
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reason of postDetails.reasons">
          <td>{{reason.name}}</td>
          <td>{{reason.tripped ? '✓' : '✗'}}</td>
          <td>{{reason.confidence}}</td>
          <td>
            <a href="/reasons/{{reason.reasonId}}">{{reason.seen}}</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</ng-container>